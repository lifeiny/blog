[{"title":"Cospectrum and Cross-spectrum in Turbulent Flow","url":"/2023/10/16/Cospectrum-and-Cross-spectrum-in-Turbulent-Flow/","content":"Turbulence Spectrum Calculation Guide\nHow to calculate the cospectrum and cross-spectrum in turbulent flow?The cospectrum and cross-spectrum are fundamental tools in turbulence analysis, especially when examining the relationship between two fluctuating quantities in turbulent flows. In a broad sense, they provide a frequency decomposition of the covariance between two signals. Here’s how to compute them:\n\nDefinitions:\n\nLet $u(t)$ and $v(t)$ be two fluctuating quantities (e.g., two components of velocity).\nTheir Fourier transforms are $U(f)$ and $V(f)$, respectively.\n\n\nFourier Transform:Compute the Fourier transforms of the signals using the Fast Fourier Transform (FFT). Many software packages like MATLAB, Python’s numpy, or others offer FFT capabilities.\n$U(f) = FFT(u(t))$\n$V(f) = FFT(v(t))$\n\nCross-spectrum:The cross-spectrum $S_{uv}(f)$ is given by the product of one signal’s Fourier transform and the complex conjugate of the other’s:\n$S_{uv}(f) = U(f) \\times V^*(f)$\nwhere $V^*(f)$ is the complex conjugate of $V(f)$.\n\nCospectrum:The cospectrum $C_{uv}(f)$ is the real part of the cross-spectrum:\n$C{uv}(f) = Re[S{uv}(f)]$\nIt represents the in-phase components of the signals.\n\nQuadrature Spectrum (optional):The imaginary part of the cross-spectrum is the quadrature spectrum $Q_{uv}(f)$:\n$Q{uv}(f) = Im[S{uv}(f)]$\nIt represents the out-of-phase components of the signals.\n\nNormalization:Typically, the cospectrum and quadrature spectrum are normalized by the total variance of the signals. This gives a more interpretable result in terms of the contribution of different frequency bands to the total covariance.\n\nInterpretation:\n\nPositive values of the cospectrum at a given frequency indicate that the two signals are in phase at that frequency, contributing positively to their covariance.\nNegative values mean the signals are out of phase, contributing negatively to their covariance.\nThe quadrature spectrum can give insights into the phase lag between the signals.\n\n\nWindowing and Averaging:\n\nTo improve the statistical reliability of the spectra, it’s common to split the data into segments, compute spectra for each segment, and then average the results. This method is called “ensemble averaging”.\nBefore Fourier transforming, each segment should be multiplied by a window function (like a Hamming or Hanning window) to reduce spectral leakage.\n\n\n\nRemember that interpreting turbulence spectra, especially the cross-spectrum and cospectrum, requires a good understanding of the physics of the flow and the interactions between different flow structures. The importance of the frequency domain representation lies in its ability to differentiate between fluctuations occurring at different scales or frequencies, giving insights into the underlying mechanisms of turbulence.\nThe physical meaning of cospetrum and cross-spectrum in turbulent flowThe cospectrum and cross-spectrum are statistical tools that provide insights into the interactions between different turbulent structures and scales. They’re especially important when analyzing the relationship between two fluctuating quantities in turbulent flows, like velocity components. Let’s delve into their physical meanings:\n\nCross-spectrum:\n\nThe cross-spectrum $S_{uv}(f)$ represents the relationship between two fluctuating quantities (e.g., $u$ and $v$ velocity components) in the frequency domain.\nIf you are examining two identical signals, the cross-spectrum becomes the power spectrum of the signal, showing the distribution of energy across frequencies.\n\n\nCospectrum:\n\nThe cospectrum $C_{uv}(f)$ is the real part of the cross-spectrum. It represents the in-phase relationship between the two signals as a function of frequency.\nPhysically, positive values of the cospectrum at a specific frequency indicate that fluctuations of the two signals at that frequency tend to occur simultaneously (in-phase). In turbulence, this can indicate that specific turbulent structures or events cause simultaneous changes in both quantities.\nNegative values at a frequency mean the signals fluctuate in an anti-phase manner at that frequency; when one signal has a positive anomaly, the other tends to have a negative anomaly.\n\n\nPhysical Interpretation:\n\nFor example, in boundary layer flows, there might be large, coherent structures like vortices. If the cospectrum of the streamwise (u) and vertical (w) velocities is positive at a specific low frequency, this suggests that these structures are causing simultaneous upward and forward motions in the flow.\nOn the other hand, if the cospectrum is negative, it might indicate that when there’s an upward motion in the flow (positive w velocity), there’s a simultaneous slowing down of the streamwise motion (negative u velocity anomaly).\nBy examining the scale or frequency at which these interactions are strongest, researchers can gain insights into the size or timescale of the dominant structures causing these interactions.\n\n\nQuadrature Spectrum (for completeness):\n\nThe quadrature spectrum is the imaginary part of the cross-spectrum and provides insights into the phase difference between two signals. If the quadrature spectrum is significant at a certain frequency, it indicates a consistent phase difference between the signals at that frequency, meaning one signal consistently leads or lags the other.\n\n\nImportance in Turbulence Research:\n\nTurbulence is inherently multiscale and chaotic. The interactions between different scales of motion are fundamental to the energy cascade process and the overall dynamics of turbulence. By analyzing the cospectrum and cross-spectrum, researchers can identify and quantify these interactions.\nThis becomes especially critical in studies related to turbulence modeling, atmospheric boundary layer flows, turbulent combustion, and any application where understanding the interplay between different scales or components of motion is crucial.\n\n\n\nIn summary, the cospectrum and cross-spectrum provide valuable insights into the frequency-dependent interactions between turbulent quantities. They help researchers dissect the complex dance of turbulent structures and their impacts on flow properties.\n","categories":["turbulence"],"tags":["turbulence"]},{"title":"Modal Analysis of Fluid Flows","url":"/2022/07/11/Modal-Analysis-of-Fluid-Flows/","content":"","categories":["python"],"tags":["turbulence","POD"]},{"title":"Numpy and Matrix","url":"/2022/07/03/Numpy%20and%20Matrix/","content":"","categories":["python"],"tags":["numpy","python"]},{"title":"Single-Point Correlation in Turbulent Flow","url":"/2023/10/13/Single-Point-Correlation-in-Turbulent-Flow/","content":"Calculate Single-Point Correlation in Turbulent FlowThe single-point correlation is a measure of the self-similarity of a turbulent flow at a given point, and it can be used to understand the turbulent structures, such as eddies. In fluid mechanics, correlations provide statistical descriptions of turbulence.\n1. Basic ConceptFor a scalar field  $\\phi(t, \\mathbf{x})$, the auto-correlation  $R{\\phi\\phi}$ at a point $\\mathbf{x}$ is defined as:$R{\\phi\\phi}(\\tau, \\mathbf{r}) = \\langle \\phi(t, \\mathbf{x}) \\phi(t + \\tau, \\mathbf{x} + \\mathbf{r}) \\rangle$where $\\langle \\cdot \\rangle$ denotes the ensemble average, $\\tau$ is the time delay, and $\\mathbf{r}$ is the spatial separation.\n2. Procedure to Calculate Single-Point Correlation\nData Collection: Acquire a time series of the quantity of interest (e.g., velocity) at a particular spatial point in the flow. This could be done using a hot-wire anemometer, laser Doppler velocimetry, or any other appropriate measurement technique for turbulent flows.\n\nTime Averaging: Remove any mean component by taking an average over the time series and then subtracting this average from the entire series.\n\nComputing the Correlation: For each time delay $\\tau$, multiply the value of the signal at time $t$ with that at $t + \\tau$ and average this over all $t$. This gives you the correlation at delay $\\tau$.\n\nNormalization: Divide the correlation function by its value at $\\tau = 0$ to obtain a normalized auto-correlation function that varies between 1 (at $\\tau = 0$ ) and 0 (as  $\\tau$  becomes very large).\n\n\n3. Extracting Eddy Size\nIdentify Zero Crossing: The point where the auto-correlation drops to zero for the first time represents a characteristic time scale $\\tau_0$ of the turbulent eddies. \n\nConvert Time to Length Scale: If you’re analyzing a velocity signal, the characteristic length scale (or eddy size) $ L$ can be approximated using the Taylor’s hypothesis: $L = U \\tau_0$where $ U$ is the mean velocity of the flow.\n\n\n4. Notes\nWhile single-point correlations give insights into the scale of the eddies, they don’t provide full spatial information. For more spatially-resolved insights, two-point correlations or spatial spectra might be needed.\nIn practical applications, turbulence is often non-stationary. This means that the statistical properties can vary over time, which can complicate the interpretation of single-point correlations.\n\nThis procedure provides a basic understanding of how one might compute single-point correlations in turbulent flows and then use them to deduce information about eddy sizes. Actual implementations might have additional nuances based on the specific details of the flow and the experimental setup.\nHow to get the signals at each time delay?When you have a time series of data points (for example, velocity measurements taken at regular time intervals), the “signal” at each time delay $\\tau$ is obtained by pairing data points that are $ \\tau$ apart in the time series. Here’s how you would obtain these signals:\nProcedure:\nChoose the Time Delay $\\tau$: Start with $\\tau = 0$, then $\\tau = \\Delta t$ (where $\\Delta t$ is your sampling time interval), then $\\tau = 2\\Delta t$, and so on, up to a maximum value that makes sense for your analysis.\n\nPairing Data Points: For each $\\tau$, pair each data point $\\phi(t)$ with the data point $\\phi(t+\\tau)$.\n\nFor $\\tau = 0$: Every data point is paired with itself.\nFor $\\tau =\\Delta t$: The first data point is paired with the second, the second with the third, and so on.\nFor $\\tau = 2\\Delta t$: The first data point is paired with the third, the second with the fourth, and so on.\n\n\nCompute the Product: For each pair, compute the product $\\phi(t) \\times \\phi(t+\\tau)$.\n\nAverage the Product: Compute the average of these products over all data points to get the correlation for that $\\tau$. This is essentially:$R(\\tau) = \\frac{1}{N-\\tau/\\Delta t} \\sum_{t=1}^{N-\\tau/\\Delta t} \\phi(t) \\phi(t+\\tau)$Where $N$ is the total number of data points in your time series.\n\nRepeat for All $\\tau$: Repeat the process for all desired values of $\\tau$ to obtain the correlation function.\n\n\nNotes:\nThe maximum $\\tau$ you consider should be less than the total length of your time series. Typically, you’ll choose a maximum $\\tau$ that is less than this to ensure a sufficient number of pairs at each $\\tau$ for a statistically significant average.\n\nAs $\\tau$ increases, the number of data pairs available decreases. This is because, for a given $\\tau$, the last $\\tau/\\Delta t$ data points of the series don’t have a partner $\\tau$ apart. As a result, the statistical reliability of the correlation may decrease for large $\\tau$.\n\nIn practice, you would use software (e.g., MATLAB, Python’s NumPy) to compute these correlations rather than doing it manually.\n\n\nBy following this procedure, you will have computed the auto-correlation of the time series at various time delays $\\tau$, providing insights into the temporal structure of your turbulent signal.\nWhen the first data point is paired with the second , the second with the third, and so on, how to deal with the last data point and the first data point in another group since there is no additional data point to be paired with?\nYour understanding is correct. When you’re pairing data points separated by a time delay $\\tau$, as $\\tau$ increases, there will be fewer pairs to consider because the end of the dataset is reached. Here’s how you handle this:\nHandling the End of the Dataset:\nFor $\\tau = \\Delta t$:\n\nThe first data point pairs with the second, the second with the third, and so on.\nThe last data point (let’s call it the $N^{th}$ data point) will not have a pair because there’s no $N+1$ data point.\n\n\nFor $\\tau = 2\\Delta t$:\n\nThe first data point pairs with the third, the second with the fourth, and so on.\nThe $N-1$ data point will pair with the $N$ data point, but then both the $N-1$ and $N$ data points will not have pairs for subsequent larger time delays.\n\n\nGeneral Rule:\n\nFor any given $\\tau$, the last $\\tau/\\Delta t$ data points will not have a partner $\\tau$ apart. These points are not included in the computation for that $\\tau$.\n\n\n\nImportant Notes:\nAs you increase $\\tau$, the number of pairs available for computing the correlation decreases. This is why the statistical reliability of the correlation may reduce for large $\\tau$.\n\nThe above explanation assumes that you’re not using a periodic boundary condition or any other method to artificially create pairs. For typical correlation computations of a time series in turbulence studies, you don’t wrap around to the beginning of the dataset.\n\nThe normalization or averaging process should account for the reduced number of pairs. When computing the average product for each $\\tau$, you’ll divide by the actual number of pairs for that $\\tau$ rather than always dividing by $N$.\n\n\nBy taking care to properly pair data and ensuring that the normalization/averaging process accounts for the varying number of pairs at each $\\tau$, you can correctly compute the auto-correlation of your dataset.\n2023/10/13\n","categories":["turbulence"],"tags":["turbulence"]},{"title":"Notes","url":"/2024/04/01/Notes/","content":"NotesConcept1. Boundary LayerThe troposphere extends from the ground up to an average altitude of 11km, but often  only the lowest couple kilometers are directly modified by the underlying surface. We can  define the boundary layer as that part of the troposphere that is directly influenced by the presence of the earth’s surface, and responds to surface forcings with a timescale of about an hour or less. These forcings include frictional drag, evaporation and transpiration, heat transfer, pollutant emission, and terrain induced flow modification. The boundary layer thickness is quite variable in time and space, ranging from hundreds of meters to a few kilometers. \nBoundary layer (also known as the planetary boundary layer, PBL, or the atmospheric boundary layer, ABL) \n\n2. Inertial Sublayer(ISL)3. Roughness Sublayer(RSL)UserHow to define the RSL and ISL in atmospheric boundary layer flow?ChatGPTThe atmospheric boundary layer (ABL) is the part of the troposphere that is directly influenced by the presence of the earth’s surface and responds to surface forcings, such as heat, moisture, and momentum transfers, over a timescale of an hour or less. Within the ABL, the Roughness Sublayer (RSL) and the Inertial Sublayer (ISL) are two important concepts that help in understanding the distribution and transfer of scalars (e.g., temperature, moisture) and momentum near the surface.\nRoughness Sublayer (RSL)The Roughness Sublayer is the portion of the atmospheric boundary layer immediately above the ground surface, extending upwards to a few heights of the roughness elements (such as trees, buildings, or other surface features). The depth of the RSL depends on the nature and distribution of the surface roughness. The RSL is characterized by:\n\nHigh levels of turbulence caused by the mechanical breakup of the airflow over and around the roughness elements.\nNon-logarithmic velocity profiles, unlike in the layers above, due to the direct influence of the roughness elements on the flow.\nEnhanced scalar gradients (such as temperature and humidity) due to the close proximity to sources and sinks at the surface.\n\nInertial Sublayer (ISL)The Inertial Sublayer lies above the RSL and extends up to the lower portion of the surface layer, which itself is part of the larger atmospheric boundary layer. The ISL is characterized by:\n\nA relatively uniform flow where the effects of the surface roughness are less pronounced, and the flow is primarily influenced by the earth’s rotation and the resulting geostrophic winds.\nLogarithmic velocity profiles, indicative of a turbulent, but more homogeneous flow than in the RSL.\nReduced direct influence from the surface roughness, allowing for the application of Monin-Obukhov similarity theory, which describes the profiles of wind speed, temperature, and moisture using dimensionless stability parameters.\n\nDefining RSL and ISLThe exact height and characteristics of the RSL and ISL can vary significantly depending on local surface roughness, atmospheric stability (which itself is influenced by surface heating or cooling), and the presence of obstacles or features that affect the flow. Generally, the RSL is considered to extend from the surface to roughly 1 to 2 times the height of the roughness elements, while the ISL is found directly above the RSL and extends to the point where the effects of surface roughness become negligible, and the flow characteristics are more influenced by the larger-scale atmospheric motions.\nIn practical applications, defining the exact boundaries of the RSL and ISL requires empirical data and modeling, as these layers are dynamic and respond to changing atmospheric conditions. Researchers and practitioners use various measurement techniques, including towers equipped with anemometers and thermometers, lidar, and sodar, to study these layers and their interactions with the surface.UserHow to get the RSL and ISL height by a wind profile?ChatGPTDetermining the heights of the Roughness Sublayer (RSL) and the Inertial Sublayer (ISL) from a wind profile involves analyzing the vertical distribution of wind speeds within the Atmospheric Boundary Layer (ABL). These analyses often require field measurements collected from meteorological towers, lidar, or sodar systems equipped with anemometers at various heights. Here’s a general approach to estimate the RSL and ISL heights from wind profile data:\n1. Collect and Prepare Wind Profile DataWind speed measurements should be collected at multiple heights above the ground. The more levels of measurement available, the more detailed the profile analysis will be. Ensure the data are averaged over a suitable period (e.g., 10 to 30 minutes) to filter out short-term fluctuations and highlight the underlying profile characteristics.\n2. Analyze the Logarithmic Wind ProfileThe wind profile in the ISL (and part of the surface layer above it) can often be represented by a logarithmic relationship between wind speed ((U)) and height ((z)):\n[ $U(z) = \\frac{u_*}{\\kappa} \\ln \\left( \\frac{z - d}{z_0} \\right) $]\nwhere:\n\n($U(z)$) is the wind speed at height ($z$),\n($u_*$) is the friction velocity,\n($\\kappa$) is the von Kármán constant (approximately 0.4),\n($d$) is the displacement height, often relevant in environments with considerable canopy or obstacle height,\n($z_0$) is the roughness length.\n\nPlotting wind speed against the logarithm of height and fitting this equation allows for identification of the logarithmic layer, primarily associated with the ISL. The best fit to this logarithmic profile helps to identify where the profile begins to deviate from the logarithmic behavior, usually marking the transition from the ISL to the RSL or canopy layer below.\n3. Identify the RSL and ISL Heights\nRSL Height: Below the height where the logarithmic wind profile begins, deviations due to the influence of surface roughness elements (e.g., buildings, vegetation) become noticeable. The layer between the ground and where the logarithmic fit becomes appropriate is considered the RSL. The upper boundary of the RSL is somewhat subjective but is generally identified where the wind profile starts to follow the logarithmic relationship closely.\n\nISL Height: The ISL is characterized by the range over which the logarithmic wind profile equation provides a good fit to the observed wind speeds. The upper boundary of the ISL is less distinctly defined but transitions into the surface layer, where the effects of atmospheric stability become significant, and the Monin-Obukhov similarity theory applies.\n\n\n4. Considerations for Stability and Roughness\nAtmospheric Stability: The stability of the atmosphere (neutral, stable, or unstable) affects the wind profile shape. Corrections for stability can be applied using Monin-Obukhov similarity theory, particularly for heights above the ISL.\nSurface Roughness: The value of the roughness length ((z_0)) and displacement height ((d)) are crucial for accurately determining the wind profile and, by extension, the heights of the RSL and ISL. These values are often estimated based on the surface characteristics or through more sophisticated modeling techniques.\n\nThis process involves a combination of empirical data analysis and theoretical modeling. Advanced techniques, including numerical modeling and the use of specialized instrumentation (like sonic anemometers for turbulence measurements), may provide more precise insights into the characteristics of the RSL and ISL within the ABL.UserCould you please give me a matlab code to do the fitting to identify the ISL?ChatGPTCertainly! To identify the Inertial Sublayer (ISL) by fitting a logarithmic wind profile to wind speed data collected at various heights, you can use MATLAB’s curve fitting tools. The logarithmic wind profile equation, which is often valid within the ISL, is given by:\n[ $U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z - d}{z_0}\\right) $]\nwhere:\n\n(U(z)) is the wind speed at height (z),\n(u_*) is the friction velocity,\n(\\kappa) is the von Kármán constant (approximately 0.4),\n(d) is the displacement height (often 0 for simplicity in basic applications),\n(z_0) is the roughness length.\n\nFor this example, I’ll simplify the equation by assuming (d = 0) and treating ( \\frac{u_*}{\\kappa} ) and (z_0) as fitting parameters. Here’s a MATLAB script that fits the logarithmic profile to the data and plots the results:\n% Example wind speed data (m/s) at various heights (m)z = [2, 4, 10, 20, 40]; % Heights above groundU = [1.2, 1.8, 2.5, 3.0, 3.8]; % Wind speeds% Ensure variables are column vectorsz = z(:);U = U(:);% Define the logarithmic wind profile function% Assuming d = 0 for simplicitylogWindProfile = @(b, z) (b(1) .* log(z ./ b(2)));% Initial guesses for [u_*/kappa, z_0]initialGuess = [0.1, 0.1]; % These are rough guesses and may need adjustment% Curve fitting[beta, R, ~, CovB] = nlinfit(z, U, logWindProfile, initialGuess);% Calculate fitted wind speedsU_fit = logWindProfile(beta, z);% Plottingfigure;scatter(z, U, &#x27;filled&#x27;);hold on;plot(z, U_fit, &#x27;-r&#x27;);xlabel(&#x27;Height above ground (m)&#x27;);ylabel(&#x27;Wind Speed (m/s)&#x27;);legend(&#x27;Measured Wind Speed&#x27;, &#x27;Fitted Logarithmic Profile&#x27;, &#x27;Location&#x27;, &#x27;best&#x27;);title(&#x27;Wind Profile Fitting&#x27;);grid on;% Display fitting parametersfprintf(&#x27;Fitted Parameters:\\n&#x27;);fprintf(&#x27;u_*/kappa: %f\\n&#x27;, beta(1));fprintf(&#x27;z_0 (roughness length): %f m\\n&#x27;, beta(2));\nThis script does the following:\n\nDefines example wind speed data at various heights.\nAssumes (d=0) and fits the logarithmic wind profile to the data.\nUses nlinfit for nonlinear curve fitting, which requires the Statistics and Machine Learning Toolbox.\nPlots the measured wind speeds and the fitted logarithmic profile for visual comparison.\nPrints the fitted parameters, which include a combined term for friction velocity and von Kármán constant, and the roughness length.\n\nMake sure to replace the example z and U variables with your actual measurements. The initial guesses for the fitting parameters might need adjustment based on your specific data set.UserIf the starting point of wind profile is not z = 0, how to do the fitting?ChatGPTIf the starting point of your wind profile data is not at (z = 0), which is common in practical measurements due to instrument limitations or obstacles, you can still fit the logarithmic wind profile to your data by adjusting the model slightly. The key adjustment involves ensuring your fitting function accounts for the actual range of heights where your measurements start. The logarithmic wind profile remains the same, but you’ll be fitting it to data that starts from a minimum height (z_{\\text{min}}) rather than from ground level.\nHere’s how you can modify the MATLAB code to handle such cases:\n% Example wind speed data (m/s) at various heights (m), starting above z=0z = [10, 20, 30, 40, 50]; % Heights above ground in metersU = [2.3, 3.2, 3.8, 4.1, 4.5]; % Corresponding wind speeds in m/s% Ensure variables are column vectorsz = z(:);U = U(:);% Define the logarithmic wind profile function accounting for z starting above 0logWindProfile = @(b, z) (b(1) .* log((z - b(3)) ./ b(2)));% Initial guesses for [u_*/kappa, z_0, d]initialGuess = [0.1, 0.1, 0]; % These are rough guesses and may need adjustment% Curve fitting[beta, R, ~, CovB] = nlinfit(z, U, logWindProfile, initialGuess);% Calculate fitted wind speedsU_fit = logWindProfile(beta, z);% Plottingfigure;scatter(z, U, &#x27;filled&#x27;);hold on;plot(z, U_fit, &#x27;-r&#x27;);xlabel(&#x27;Height above ground (m)&#x27;);ylabel(&#x27;Wind Speed (m/s)&#x27;);legend(&#x27;Measured Wind Speed&#x27;, &#x27;Fitted Logarithmic Profile&#x27;, &#x27;Location&#x27;, &#x27;best&#x27;);title(&#x27;Wind Profile Fitting&#x27;);grid on;% Display fitting parametersfprintf(&#x27;Fitted Parameters:\\n&#x27;);fprintf(&#x27;u_*/kappa: %f\\n&#x27;, beta(1));fprintf(&#x27;z_0 (roughness length): %f m\\n&#x27;, beta(2));fprintf(&#x27;Displacement height (d): %f m\\n&#x27;, beta(3));\nIn this adjusted script, the fitting function logWindProfile now includes an additional parameter (b(3)), which represents the displacement height (d). This parameter can compensate for the data starting above the ground. Note that in practical ABL studies, (d) is often significant in environments with tall roughness elements like forests or urban areas, where it represents the height below which wind speeds are significantly reduced due to obstructions.\nIn this context, adding (d) as a fitting parameter allows you to effectively shift the baseline of your logarithmic profile to match the starting point of your measurements. This can improve the fit if your data indeed start from a height where the wind profile is already influenced by surface roughness or other factors.\nRemember, the quality of the fit and the interpretation of (d) will depend on the characteristics of your measurement site and the height range of your data. It’s also crucial to have a good initial guess for the parameters to ensure the fitting process converges to a meaningful solution.UserHow to determine the displacement height d? is it equal to the distance from ground to the starting point?ChatGPTThe displacement height ((d)) in the context of atmospheric boundary layer (ABL) studies is not simply the distance from the ground to the starting point of your wind profile measurements. Instead, it has a specific physical meaning and is determined through empirical or theoretical methods. The displacement height is particularly important in environments with tall roughness elements, such as forests or urban areas, and represents the height above the ground at which the wind speed theoretically reduces to zero due to the drag induced by these roughness elements. It effectively shifts the zero plane of the wind profile upwards, accounting for the bulk effect of obstacles on the airflow.\nDetermining Displacement Height ((d))There are several methods to estimate (d), depending on the available data and the specific characteristics of the study area:\n1. Empirical RelationsFor certain types of terrain or vegetation, empirical relations based on measurements have been developed to estimate (d). For example, (d) is often estimated as a fraction of the vegetation height (($h_v$)) for forests or crops:\n[ $d \\approx \\frac{2}{3} h_v$ ]\nThis ratio can vary depending on the type of vegetation or surface roughness.\n2. Direct MeasurementIn urban environments or areas with well-defined obstacles, (d) can sometimes be estimated by direct observation and measurement of the effective height of the obstacles. This approach requires a detailed understanding of the area’s geometry and the distribution of roughness elements.\n3. Profile FittingWhen detailed wind profile data are available, ($d$) can be estimated by fitting a theoretical wind profile (such as the logarithmic wind profile) to the measured data. This involves treating ($d$) as a fitting parameter alongside the roughness length (($z0$)) and the friction velocity (($u*$)). The fitting process adjusts ($d$) to match the observed profile, subject to the constraints of the theoretical model.\n4. Numerical ModelingAdvanced numerical models that simulate the $ABL$ and its interaction with surface roughness can also be used to estimate ($d$). These models require detailed inputs about the surface characteristics but can provide spatially and temporally resolved estimates of ($d$) and other boundary layer parameters.\nIs (d) Equal to the Starting Height of Measurements?No, ($d$) is not inherently equal to the height at which your measurements start. Instead, it’s a theoretical concept that describes how much the presence of surface roughness “displaces” the apparent origin of the wind profile above the actual ground level. The starting height of your wind speed measurements is determined by practical considerations (such as the minimum height at which instruments can be mounted), while ($d$) is a parameter that needs to be estimated based on the characteristics of the surface and the wind profile itself.\nIn summary, determining the displacement height (($d$)) requires an understanding of the surface conditions and often involves empirical estimates, direct measurements, profile fitting, or numerical modeling, rather than being directly equated to the height at which wind speed measurements commence.UserSo it is a endless loop because I have to use d to do the  fitting, but if I want to know d, I still need to calculate it from fitting?ChatGPTIt may seem like a loop, but it’s not necessarily endless. The process of estimating the displacement height ((d)) through wind profile fitting is iterative and relies on adjusting (d) (along with other parameters like ($z0$) and ($u*$)) to best match the measured wind profile data. Here’s how the process can work more effectively:\nStarting with Initial Estimates\nInitial Guesses: You often start with initial guesses for (d), ($z0$), and ($u*$) based on empirical knowledge, literature values for similar environments, or simple assumptions (e.g., (d) as a fraction of the height of roughness elements).\n\nFitting the Model: You then fit the wind profile model to your data with these initial parameters. Modern fitting algorithms can adjust these parameters iteratively to minimize the difference between the measured wind speeds and the model.\n\nRefining Estimates: The fitting process provides refined estimates of (d), ($z0$), and ($u*$). This step may reveal the need to adjust the model or the fitting parameters, leading to additional iterations.\n\n\nBreaking the Loop\nPhysical Reasoning: The physical significance of (d) and ($z_0$) helps break what might seem like a loop. (d) represents the effective shift of the wind profile’s origin due to obstacles, while ($z_0$) characterizes the surface’s aerodynamic roughness. Both have physical interpretations that guide their initial estimates.\n\nIterative Refinement: The iterative process of fitting and refining the parameters allows for convergence on a set of values that best represent the actual wind profile. It’s not so much a loop as it is a convergence process.\n\nIndependent Methods: For certain environments, (d) can be estimated independently (e.g., a fraction of canopy height in forests) and then used as a fixed parameter in fitting, reducing the number of variables that need to be iteratively adjusted.\n\n\nPractical ApproachIn practice, if the landscape or the height of roughness elements (like trees or buildings) is fairly uniform, initial estimates of (d) can be made based on empirical relationships or direct measurements, reducing the dependency loop. The fitting process then fine-tunes these estimates based on how well they match the observed wind profile.\nConclusionThe iterative nature of estimating (d) through profile fitting does not constitute an endless loop but rather a convergent process guided by physical principles, empirical knowledge, and mathematical optimization techniques. By carefully selecting initial guesses and iteratively refining them, it’s possible to accurately model the wind profile and estimate key parameters, including the displacement height.Userso please give me a full code that I don’t know d, and the starting point of the wind profile is not the ground level, under which to do the fitting and confirm the RSL and ISL.ChatGPTTo create a MATLAB script that fits a wind profile to measured data without prior knowledge of the displacement height ((d)) and when measurements do not start at ground level, we’ll assume (d) and the roughness length ((z0)) are unknowns to be estimated. This script will use the logarithmic wind profile equation, allowing (d) and (z_0) to be fitting parameters alongside a scale factor that essentially represents (\\frac{u}{\\kappa}), where (u_) is the friction velocity and (\\kappa) is the von Kármán constant.\nThe script will perform the following steps:\n\nDefine the measured wind speeds and corresponding heights.\nFit the logarithmic wind profile to this data, estimating (d), (z_0), and the scale factor.\nPlot the measured data and the fitted profile for comparison.\n\nHere is the MATLAB code:\n% Required for using nlinfit if Statistics and Machine Learning Toolbox is availableif ~exist(&#x27;nlinfit&#x27;, &#x27;file&#x27;)    error(&#x27;This script requires the Statistics and Machine Learning Toolbox.&#x27;);end% Example wind speed data (m/s) at various heights (m), not starting from z=0z = [10, 20, 30, 40, 50]&#x27;; % Heights above ground (ensure column vector)U = [2.3, 3.2, 3.8, 4.1, 4.5]&#x27;; % Wind speeds (ensure column vector)% Logarithmic wind profile function including displacement height (d) and roughness length (z0)logWindProfile = @(b, z) b(1) .* log((z - b(3)) ./ b(2));% Initial guesses for [scale factor, z_0, d]% Note: These should be based on the expected conditions but are generally unknown.% Here, we provide a reasonable starting point for the optimization.initialGuess = [0.1, 1, 5]; % [Scale factor, z0, d]% Nonlinear curve fittingopts = statset(&#x27;nlinfit&#x27;);opts.RobustWgtFun = &#x27;bisquare&#x27;;[beta, ~, R, ~, ~] = nlinfit(z, U, logWindProfile, initialGuess, opts);% Generate a smooth curve for the fitted profile over the observed height rangez_fit = linspace(min(z), max(z), 100)&#x27;;U_fit = logWindProfile(beta, z_fit);% Plotting the resultsfigure;plot(U, z, &#x27;bo&#x27;, &#x27;MarkerFaceColor&#x27;, &#x27;b&#x27;); hold on; % Measured dataplot(U_fit, z_fit, &#x27;r-&#x27;, &#x27;LineWidth&#x27;, 2); % Fitted profilexlabel(&#x27;Wind Speed (m/s)&#x27;);ylabel(&#x27;Height (m)&#x27;);title(&#x27;Wind Profile Fitting&#x27;);legend(&#x27;Measured Data&#x27;, &#x27;Fitted Logarithmic Profile&#x27;, &#x27;Location&#x27;, &#x27;Southeast&#x27;);grid on;% Display the estimated parametersfprintf(&#x27;Estimated Parameters:\\n&#x27;);fprintf(&#x27;Scale factor (u_*/kappa): %.3f\\n&#x27;, beta(1));fprintf(&#x27;Roughness length (z0): %.3f m\\n&#x27;, beta(2));fprintf(&#x27;Displacement height (d): %.3f m\\n&#x27;, beta(3));\nPoints to Note:\nInitial Guesses: The success of the fitting procedure depends significantly on the initial guesses for the scale factor, (z_0), and (d). You may need to adjust these based on your specific scenario.\n\nStatistical Toolbox Requirement: The nlinfit function used for nonlinear regression requires MATLAB’s Statistics and Machine Learning Toolbox. \n\nPlot Interpretation: The plotted results will show the measured wind speeds at their respective heights and the fitted logarithmic wind profile. This visual comparison can help confirm the appropriateness of the fitted model and the estimated parameters, including the displacement height, which aids in identifying the RSL and ISL.\n\n\nThis script provides a basic framework for fitting a logarithmic wind profile to measured data when starting above ground level and without prior knowledge of the displacement height. Adjustments may be necessary to better suit specific data sets or environmental conditions.\n4. Mixing Layer5. Drag CoefficientData Process1. SpectrumDifference between fft and pwelch in Matlab. The following code can give the correct amplitude.\nclear allformat long\nfs = 20000;N = 1200000;  %data lengtht = (0:N-1)/fs;rawData = importdata(&#39;F:\\LiFei\\Data\\Hotwire\\Nanshan20240127\\Data\\y-50mm\\x_0mm\\20240202_x0000.0_y-050.0_z0065.0.out&#39;);data =rawData.data;u = data(1:1200000,4);flu = u-mean(u);\np_fft = fft(flu,N);psd_fft = 2*abs(p_fft(1:end/2+1)).^2/fs/N;  %power spectra density is energy density/t，energy spectra is the absolute of the fft result. Due two the symmetry of fft, need to multiply 2 to calculate all the power.  The frequency of the first point is 0 Hz, which is not symmetrical.freq = linspace(0,fs/2,length(psd_fft));[pxx,f] = pwelch(flu,[],[],[],20000); % The second parameter denotes the windows, we may use hamming(N) windows here to reduce the data.figure;plot(freq, psd_fft);set(gca, &#39;xscale&#39;, &#39;log&#39;);set(gca, &#39;yscale&#39;, &#39;log&#39;);title(&#39;fft methods for PSD&#39;);grid onhold on% figure;plot(f, pxx);set(gca, &#39;xscale&#39;,&#39;log&#39;);set(gca, &#39;yscale&#39;,&#39;log&#39;);title(&#39;pwelch method for PSD&#39;);grid on\n\n\n\n2. Amplitude modulationSingle-pointTwo-pointPredictive model3. Statistical PropertiesFigure1.concept related to the large-scale and small-scale.\nFrom Blackman 4\n\n\nPapers1. The role of coherent structures in subfilter-scale dissipation of turbulence measured in the atmospheric surface layerField Measurement, 16 sonic anemometers, 6m high, 3m wide, \nLES subfilter-scale (SFS),\nField measurement \n\nsampling frequency 20Hz. The original data were separated into 30-min periods and individual subsets were selected based on the level of stationarity of wind direction, wind speed and turbulent statistics. \nObukhov length:\n\nL=\\frac{-u_{*}^{3}\\left< \\theta \\right>}{\\kappa g\\left< u_3'\\theta ' \\right>}z/L =+0.10 (weakly stable conditions, top panel)\nz/L = −2.39 (unstable conditions, bottom panel).\nThe use of Taylor’s hypothesis has been well accepted for data measured in the atmospheric surface layer with turbulence intensities up to 30% and more \n\nWyngaard 1977. Wyngaard J C and Clifford S F 1977 Taylor’s hypothesis and high-frequency turbulence spectra &#8617;\n\n[Wyngaard J C and Clifford S F 1977 Taylor’s hypothesis and high-frequency turbulence spectra]\n\nVelocity gradient calculation:\nThe gradients of the filtered velocity and temperature were computed along all three axial directions at the location where the vertical and horizontal arrays intersect. This was done using a centered finite-differencing scheme with the filtered data from the nearest sensors for the spanwise and vertical gradients, and the filtered data from the time series at half the filter scale (invoking Taylor’s hypothesis) for the streamwise gradients.\n\nTwo point correlation\n\nR\\left( r \\right) =\\left< u\\left( y,t \\right) u\\left( y+h,t \\right) \\right> /\\left( \\sigma _{u\\left( y,t \\right)}{\\sigma _u}_{\\left( y+h,t \\right)} \\right)\nBy finding the lag of the maximum correlation between each pair, a linear relation can be found (by least-squares fit) between the measurement height and the lag associated with the maximum correlation. The arctangent of the slope yields a characteristic inclination angle along which the maximum correlations occur.\n2. Packet structure of surface eddies in the atmospheric boundary layerThey reveal large-scale ramp-like structures with downstream inclination of 3◦–35◦. This inclination is interpreted as the hairpin packet growth angle following the hairpin vortex packet model of Adrian, Meinhart, and Tomkins.\nHairpin vortex\n\nThis model provides a possible basis for numerous structural features of wall turbulence including very-long, low-speed streaks, multiple uniform streamwise momentum zones, and the presence of large-scale structures throughout the entire boundary layer.\nThe hairpin vortex packets form a hierarchy of dynamically similar structures whose size increases in proportion to their distance above the wall, at least through the region of the logarithmic layer. But, to observe many levels of this hierarchy, it is necessary to have a very large separation between the outer scale of the boundary layer, i.e., its thickness, and the inner scale, i.e., the viscous length scale, at which the smallest vortices are formed. This scale separation increases with Reynolds number.\n3.Observations of coherent turbulence structures in the near-neutral atmospheric boundary layer4. Turbulent energy scale budget equations in a fully developed channel flowKolmogorov’s equation can be derived from the Navier–Stokes equations, using homogeneity and isotropy:\n\n-\\left< \\left( \\Delta u_1 \\right) ^3 \\right> +6\\nu \\frac{d}{dr}\\left< \\left( \\Delta u_1 \\right) ^2 \\right> =\\frac{4}{5}\\left< \\epsilon \\right> rwith the increment $\\Delta u_1\\left( r \\right) \\equiv u_1\\left( x_1+r \\right) -u_1\\left( x_1 \\right) $, where $u_1$ is the longitudinal (streamwise) velocity component, This equation indicates that the mean energy transferred at a scale $r$ is made up of both the energy lost through the turbulent advection ($-\\left&lt; \\left( \\Delta u_1 \\right) ^3 \\right&gt;$) and the energy lost by molecular destruction ($6\\nu \\frac{d}{dr}\\left&lt; \\left( \\Delta u_1 \\right) ^2 \\right&gt;$). It can be interpreted as an energy budget equation involving $\\left&lt; \\epsilon \\right&gt;$, but it can also be thought of as an equation which provides information about $\\left&lt; \\epsilon \\right&gt;$. The equation is a relatively simple means of obtaining $\\left&lt; \\epsilon \\right&gt;$, as the second- and third-order moments can be inferred from single hot-wire measurements via Taylor’s hypothesis. This equation is essentially a mean turbulent energy budget equation and does not contain high-order moments. In this form, it does not reflect the influence of small-scale (internal) intermittency. \n and $\\left&lt;\\epsilon\\right&gt;$ is the mean energy dissipation rate:\n\n\\left< \\epsilon \\right> =\\frac{1}{2}\\nu \\left< \\left( \\frac{\\partial u_i}{\\partial x_j}+\\frac{\\partial u_j}{\\partial x_i} \\right) ^2 \\right>Since spatial derivatives of velocity fluctuations are very difficult to measure accurately, additional hypotheses are necessary. Homogeneity leads to $\\left&lt; \\epsilon \\right&gt; {hom}\\equiv \\nu \\left&lt; \\left( \\frac{\\partial u_i}{\\partial x_j} \\right) ^2 \\right&gt;$, where generally the subscript indicates the method or hypothesis used to estimate $\\left&lt;\\epsilon\\right&gt;$, and the absence of a subscript signifies that the ‘true’ $\\left&lt;\\epsilon\\right&gt;$, given by $\\left&lt; \\epsilon \\right&gt; =\\frac{1}{2}\\nu \\left&lt; \\left( \\frac{\\partial u_i}{\\partial x_j}+\\frac{\\partial u_j}{\\partial x_i} \\right) ^2 \\right&gt;$, is referred to. A relatively crude approximation for $\\left&lt;\\epsilon\\right&gt;{hom}$ is obtained by supposing that the three spatial directions are equivalent so that only derivatives with respect to $x_1$ appear in the expression, namely\n\n\\left< \\epsilon \\right> _{hom}\\equiv 3\\nu \\left< \\left( \\frac{\\partial u_i}{\\partial x_1} \\right) ^2 \\right>Local isotropy results in (Monin &amp; Yaglom 1975)\n\n\\left< \\epsilon \\right> _{iso}\\equiv 15\\nu \\left< \\left( \\frac{\\partial u_1}{\\partial x_1} \\right) ^2 \\right>and this equation is the simplest and most often used relation for obtaining the mean turbulent energy dissipation rate. Its ability to provide a good approximation to the ‘true’ value of $\\left&lt;\\epsilon\\right&gt;$ hinges on whether the small-scale motion is isotropic  (the quality of the data and data processing are important).\nThe inertial range (IR) is defined as the range of scales which are much smaller than the injection scale, and much larger than the dissipative scale (comparable to the Kolmogorov length scale $\\eta≡(\\nu^3/\\left&lt;\\epsilon\\right&gt;^{1/4})$. In the IR, $-\\left&lt; \\left( \\Delta u_1 \\right) ^3 \\right&gt; +6\\nu \\frac{d}{dr}\\left&lt; \\left( \\Delta u_1 \\right) ^2 \\right&gt; =\\frac{4}{5}\\left&lt; \\epsilon \\right&gt; r$ reduces to $-\\left&lt; \\left( \\Delta u_1 \\right) ^3 \\right&gt; =\\frac{4}{5}\\left&lt; \\epsilon \\right&gt; r$. This equation can be used as a practical method to obtain $\\left&lt;\\epsilon\\right&gt;$. It should be stressed that $-\\left&lt; \\left( \\Delta u_1 \\right) ^3 \\right&gt; =\\frac{4}{5}\\left&lt; \\epsilon \\right&gt; r$ is strictly valid only when the IR is established. This is expected only at very large Reynolds numbers (e.g. Qian 1997) or when the conditions of stationarity, isotropy and homogeneity are strictly satisfied. \nEquation $-\\left&lt; \\left( \\Delta u1 \\right) ^3 \\right&gt; +6\\nu \\frac{d}{dr}\\left&lt; \\left( \\Delta u_1 \\right) ^2 \\right&gt; =\\frac{4}{5}\\left&lt; \\epsilon \\right&gt; r$ is verified only for small scales when the Taylor-microscale Reynolds number $R{\\lambda}$ is moderate (Antonia, Chambers &amp; Browne 1983, see also figure 3) ($R_{lambda} ≡ u_1^{‘}\\lambda/\\nu$, where a prime denotes the r.m.s. value and $\\lambda ≡ u_1^{‘}/(∂u_1/∂x_1)^{‘}$ is the longitudinal Taylor microscale). At larger scales, the approach to a four-fifths law is expected to be quite slow, as demonstrated by Qian (1999).\nExperiment details\nOn the centreline, the Taylor-microscale Reynolds number $R{\\lambda}$ is about 36, and the Kolmogorov length scale $η$, based on the mean energy dissipation rate $\\left&lt;\\epsilon\\right&gt;{iso}$, is about 0.5 mm. The measurement location was at 340h from the entrance. The measured mean static pressure gradient and moments of $u_1$ and $u_3$ along the centreline indicated that the flow was fully developed at $x_1 \\approx 150h$. Also note that, at the measurement location, the turbulence intensity $u_1^{‘}/U_1$ is about 4% and the ratio $u_1^{‘}/u_2^{‘}$ about 1.25 on the centreline.\nThe inclined wires allowed the determination of $u_1$ and $u_3$ fluctuations. The included angle of the two wires is about $100\\degree$. The separation between the wires was about 1.2 mm. The hot wires were etched from 2.5 µm diameter Wollaston Pt–10% Rh wires with an active length of about 0.5 mm. The length to diameter ratio of the wires was about 200. The probe was calibrated at the centreline of the channel against a Pitot tube connected to a MKS Baratron pressure transducer (least count = 0.01mm water). The yaw calibration was performed over ±24◦ (using 4◦ steps). For each angle, the probe was relocated at the centreline of the channel. The probe was traversed in the $x_3$-direction between about 1mm from the wall to 2mm beyond the centreline.\nThe hot wires were operated with constant-temperature anemometers at an overheat ratio of 1.5. The output signals from the anemometers were passed through buck and gain circuits and low-pass filtered (the cut-off frequency fc, which was in the range 400–1250Hz depending on the transverse position of the probe, was set close to the Kolmogorov frequency $U_1/2πη$). The signals were then digitized into a personal computer using a 12 bit A/D converter at a sampling frequency, $f_s$, of 2500 Hz. The record duration was about 60 s. This was estimated to be long enough for the secondand third-order moments of $∆u_1$ and $∆u_3$ to converge.\nEstimations of $\\left&lt;\\epsilon\\right&gt;$$\\left&lt;\\epsilon\\right&gt;$ obtained using different approaches.\nLawn (1971) inferred $\\left&lt;\\epsilon\\right&gt;$ from the behavior of the $u_1$-spectrum in the IR:\n\nE(k_1)=K\\left^{2/3)}k_1^{-5/3}with $K\\approx0.51$. The advantage of this approach is that the spectrum needs only to be accurately measured over a medium frequency range, as was noted by Bradshaw (1969). This is essentially the spectral equivalent of Kolmogorov’s equation in the context of determining $\\left&lt;\\epsilon\\right&gt;$. Even if the measurement of $\\left&lt;\\epsilon\\right&gt;$ is in error, the spectral method is robust and more likely to provide meaningful estimates when the Reynolds number is large enough.\n5.(2017)Turbulent kinetic energy budget in the boundary layer developing over an urban-like rough wall using PIVKarin Blackman; Laurent Perret; Isabelle Calmet; Cédric Rivet\nTo access the full TKE budget, an estimation of the dissipation (ε) using both the transport equation of the resolved-scale kinetic energy and Large-Eddy (LE) PIV models based on the use of a subgrid-scale model following the methodology used in large-eddy simulations is employed. \n(1) Can the TKE budget including dissipation be quantified using PIV measurements in an urban canopy?(2) What is the influence of the presence of the roughness elements on the TKE budget terms?(3) Which coherent structures present in the urban boundary layer are related to the occurrence of backscatter?\nExperimental details\nThe wind tunnel has working section dimensions of 2 m (width) × 2 m (height) × 24 m (length), 5:1 ratio inlet contraction, and a wind speed range of 3–10 $ms^{-1}$. \nWithin the empty wind tunnel, there is a free-stream turbulence intensity of0.5% with spanwise uniformity to within ±5% (Savory et al., 2013).\nTo initiate the boundary layer development, five 800 mm vertical tapered spires were used immediately downstream of the contraction followed by a 200 mm solid fence located 750 mm downstream of the spires. \nThe roughness elements, which consisted of $h = 50$ mm staggered cubes with a plan area packing density $\\lambda_p = 25$%.\nThe experiment was performed with a free-stream velocity $U_{\\infty}$= 5.8 $ms^{-1}$ measured with a Pitot-static tube located 15 m downstream of the inlet at the centre of the wind tunnel and $z = 1.5$ m, giving a Reynolds number, based on cube height, of $Re_h = 1.9 × 10^4$.\n\n\nLitron double cavity Nd-YAG laser (2 × 200 mJ)\nTwo CCD cameras with a 105 mm objective lens\nA frequency of 5 Hz was used between pairs of pulses\na time-delay of 500 µs was set between two images of the same pair\nThe synchronization of the cameras and laser was controlled using Dantec Dynamic Studio software\nperform the PIV analysis of the recorded images by Dantec Dynamic Studio software\nIn total 4000 pairs of images were recorded\n13 min of measurements\nThe multi-pass cross-correlation PIV processing resulted in a final interrogation window size of 32 × 32 pixels with an overlap of 50%. \nThe PIV measurements had a final spatial resolution of 1.7 mm in the streamwise and 2.2 mm in the vertical directions.\n\n\n\n==shown in one figure.==\n\n==hight order moments calculated by $\\left&lt;\\alpha^{‘3}\\right&gt;/\\left&lt;\\sigma^{3}\\right&gt;$, difference compared with $\\left&lt;\\alpha^{‘3}/\\sigma^{3}\\right&gt;$?==\n\n\n\n0=\\underset{Adv}{\\underbrace{-\\overline{u_j}\\frac{\\partial \\overline{k}}{x_j}}}\\underset{P}{\\underbrace{-\\overline{u_i'u_j'}\\frac{\\partial \\overline{u_i}}{\\partial x_j}}}\\underset{T}{\\underbrace{-\\frac{1}{2}\\frac{\\partial \\overline{u_i'u_i'u_j'}}{\\partial x_j}}}\\underset{Ψ}{\\underbrace{-\\frac{1}{\\rho}\\frac{\\partial \\overline{P'u_j'}}{x_j}}}\\underset{D_{\\mu}}{\\underbrace{+\\nu \\frac{\\partial}{\\partial x_j}\\left[ \\overline{u_j'\\left( \\frac{\\partial u_i'}{\\partial x_j}+\\frac{\\partial u_j'}{\\partial x_i} \\right) } \\right] }}-\\varepsilonThe general form of the TKE budget for a stationary flow is described in equation above, where $Adv$ is advection, $P$ is production, $T$ is turbulent transport, $Ψ$ is pressure transport, D is viscous transport, and ε is dissipation,\n\nAbove the roughness sublayer ($z/h &gt; 2$), the production of energy is balanced by the dissipation, while all other terms are negligible. Close to the obstacles [Fig. 9(a)], the strong shear layer induced by the presence of the roughness elements produces energy. This production term decreases in magnitude with downstream distance as the shear layer develops over the canopy [Fig. 9(c)]. Energy is also dissipated within the shear layer and transported to the canopy and overlying boundary layer through advection, turbulent transport, and pressure transport by the shear layer. Finally, within the canopy, pressure transport is a significant energy sink and is balanced by production and turbulent transport [Figs. 9(b) and 9(c)] except close to the upstream cube where pressure transport becomes an energy source [Fig. 9(a)]. This region, which contains a recirculation region, also exhibits high magnitudes of dissipation and weakly positive production. Away from the shear layer in Figs. 9(d) and 9(e), the production is still balanced by the dissipation; however, the pressure transport becomes weakly positive within the overlying boundary layer suggesting that energy from the shear layer is transported to these regions. \nThe present work has led to some important findings on the nature of energy production and dissipation in the urban boundary layer. However, the influence of the geometry and packing density (λp) ofthe roughness used to simulate an urban boundary layer on the TKE budget and sub-grid scale energy transfer remains to be studied. Furthermore, previous work has shown that large-scale coherent structures interact and influence small-scale structures with the shear layer through a non-linear interaction (Blackman and Perret, 2016). Future work will focus on investigating the non-linear energy transfer between these structures.\n[1] Castro, I. P., Cheng, H., and Reynolds, R., “Turbulence over urban-type roughness: Deductions from wind-tunnel measurements,” Boundary-Layer Meteorol. 118, 109–131 (2006).\n[2] Blackman, K. and Perret, L., “Non-linear interactions in a boundary layer developing over an array of cubes using stochastic estimation,” Phys. Fluids 28, 095108 (2016).\n[3] Blackman, K., Perret, L., and Savory, E., “Effect of upstream flow regime on street canyon flow mean turbulence statistics,” Environ. Fluid Mech. 15, 823–849 (2014).\n[4] Blackman, K., Perret, L., Savory, E., and Piquet, T., “Wind tunnel modeling of an idealized street canyon flow,” Atmos. Environ. 106, 139–153(2015).\n[5] Roth, M., Inagaki, A., Sugawara, H., and Kanda, M., “Small-scale spatial variability ofturbulence statistics, (co)spectra and turbulent kinetic energy measured over a regular array of cube roughness,” Environ. Fluid Mech. 15, 329–348 (2015)\n[6] Salizzoni, P., Marro, M., Soulhac, L., Grosjean, N., and Perkins, R. J., “Turbulent transfer between street canyons and the overlying atmospheric boundary layer,” Boundary-Layer Meteorol. 141, 393–414 (2011).\n[7] Savory, E., Perret, L., and Rivet, C., “Modelling considerations for examining the meanand unsteady flowin a simple urban-type street canyon,” Meterol. Atmos. Phys. 121, 1–16 (2013).\n[8] Takimoto, H., Inagaki, A., Kanda, M., Sato, A., and Michioka, T., “Lengthscale similarity of turbulent organized structures over surfaces with different roughness types,” Boundary-Layer Meteorol. 147, 217–236 (2013).\n[9] Takimoto, H., Sato, A., Barlow, J. F., Moriwaki, R., Inagaki, A., Onomura, S., and Kanda, M., “Particle image velocimetry measurements of turbulent flow within outdoor and indoor urban scale models and flushing motions in urban canopy layers,” Boundary-Layer Meteorol. 140, 295–314 (2011).\n[10] Zhu, W., van Hout, R., and Katz, J., “On the flow structure and turbulence during sweep and ejection events in a wind-tunnel model canopy,” Boundary-Layer Meteorol. 124, 205–233 (2007).\n[11] Castro, I. P., Cheng, H., and Reynolds, R., “Turbulence over urban-type roughness: Deductions from wind-tunnel measurements,” Boundary-Layer Meteorol. 118, 109–131 (2006).\n[12] Christen, A., Rotach, M. W., and Vogt, R., “The budget of turbulent kinetic energy in the urban roughness sublayer,” Boundary-Layer Meteorol. 131, 193–222 (2009).\n[13] Guala, M., Metzger, M., and McKeon, B. J., “Interactions within the turbulent boundary layer at high Reynolds number,” J. Fluid Mech. 666, 573–604 (2011).\n[14] Inagaki, A. and Kanda, M., “Organized structure of active turbulence over an array of cubes within the logarithmic layer of atmospheric flow,” Boundary-Layer Meteorol. 135, 209–228 (2010).\n[15] Jimenez, J., “Turbulent flows over rough walls,” Annu. Rev. Fluid Mech. 36, 173–196 (2004).\n[16] Marusic, I., McKeon, B. J., Monkewitz, P. A., Nagib, H. M., Smits, A. J., and Screenivasan, K. R., “Wall-bounded turbulent flows at high Reynolds numbers: Recent advances and key issues,” Phys. Fluids 22, 065103 (2010).\n[17] Michioka, T. and Sato, A., “Effect ofincoming turbulent structure on pollutant removal from two-dimensional street canyon,” Boundary-Layer Meteorol. 145, 469–484 (2012).\n[18] Perret, L. and Savory, E., “Large-scale structures over a single street canyon immersed in an urban-type boundary layer,” Boundary-Layer Meteorol. 148, 111–131 (2013).\n[19] Perret, L., Blackman, K., and Savory, E., “Combining wind-tunnel and field measurements ofstreet-canyon flowvia stochastic estimation,” BoundaryLayer Meteorol. 161, 491–517 (2016).\n[20] Sheng, J., Meng, H., and Fox, R. O., “A large eddy PIV method for turbulence dissipation rate estimation,” Chem. Eng. Sci. 55, 4423–4434 (2000).\n6.(2006)Turbulence over urban-type roughness: deductions from wind-tunnel measurementsIAN P. CASTRO,∗, HONG CHENG and RYAN REYNOLDS\nExperiment\nAll measurements were carried out around the tunnel (spanwise) centreline, about 3m downstream of the leading edge of the roughness and at a nominal free stream velocity of $10 m s^{−1}$. This gave a boundary-layer thickness of 148mm at the measurement station, a boundary-layer Reynolds number based on momentum thickness of about 12,000, a roughness length, zo, and zero-plane displacement, d, of 1.1 and 17mm, respectively, and a friction velocity, $u_∗/U_o$, of 0.07, where the latter was deduced from form drag measurements obtained by pressure-tapping one of the cubes; alternative ways of obtaining u∗ yielded lower values and gave less satisfactory fits of the mean velocity data to the log-law, as discussed by Cheng and Castro (2002). The streamwise, lateral and vertical coordinates are $(x, y, z)$, with the plane $z=0$​ being the top surface of the baseboard on which the roughness elements were located. Figure 1 shows the roughness arrangement.\n\nThe roughness sublayer extends up to $z=1.8h$ and the inertial layer up to $z=2.3h$,as deduced (and discussed) by Cheng and Castro (2002) on the basis of suitably small variations in shear stress.\nProfile\n\nThe averaged mean velocity profile shows a strong shear near $z = h$ and contains an inflection point just above that height. This characteristic has prompted the suggestion that the natural instabil-shear near z = h and contains an inflection point just above that height. This characteristic has prompted the suggestion that the natural instabilities near the top of the canopy resemble those in a plane mixing layer rather than a boundary layer (Raupach et al., 1996; Finnigan, 2000).\nSingle point correlation:==Obtaining length scales : apply Taylor’s hypothesis to the time scale.== \nThe autocorrelation coefficient\n\nR_u(\\tau) =\\frac{\\overline{u(t)u(t+\\tau)}}{\\overline{u^2}}integral time scale\n\nT_x=\\int_{0}^{\\infty } R_u(\\tau)d\\tauTaylor’s hypothesis then yields an integral length scale of $L_x =T_xU$​, where U is the local mean velocity.\nTwo point correlationTo avoid the shortcomings of applying Taylor’s hypothesis we therefore used two-point measurements to obtain spatial correlations, \n\nR_{uu}\\left( r \\right) =\\frac{\\overline{u\\left( r \\right) u\\left( r+\\delta r \\right) }}{\\sqrt{\\overline{u\\left( r \\right) ^2}}\\sqrt{\\overline{u\\left( r+\\delta r \\right) ^2}}}where $δr$ is the separation of the probes, and thence to deduce the integral length scales $L_x$, $L_y$ and$ L_z$ directly\n\nL_x=\\int_0^{x_c}{R_{uu}\\left( x \\right) dx}with the upper limit of integration determined by the first zero crossing of the correlation coefficient curve.\nIn these experiments, two single hot-wire probes were used, one of which was fixed at a certain location, and the other traversed vertically, laterally or longitudinally. \nA typical set of spatial correlation coefficients with one probe fixed at $z/h=1.25mm$ is shown in Figures 5a and b and shows profiles of the length scales deduced from a complete set of spatial correlation data.\n\nStructure angleThe structure angle, denoting the most likely inclination of the ‘average’ eddy structure (or packet), can be defined as\n\n\\theta =\\mathrm{arc}\\tan \\frac{\\varDelta z_m}{\\varDelta x}where $\\Delta x$ is the horizontal probe separation and $\\Delta zm$ is the vertical separation which yields maximum $R{uu}$. It should be emphasised that these structure angles do not indicate the orientation of individual eddies as they are swept past the measuring point. Rather, they are in some sense an average orientation of all the eddies of different spatial scales and stages of growth and decay and should therefore be interpreted with caution.\n\nIt is clear that as the fixed probe height increased from z/h=1.0 to 2.75, the structure angle decreases from 18.4◦ to 10.3◦, eventually becoming almost constant (about 10◦) for greater reference heights. (Ultimately it must become zero when the fixed probe reaches the free stream). This trend is opposite to the behaviour found in smooth-wall boundary layers (Adrian et al., 2000; Marusic, 2001) where the structure angle increased monotonically with increasing distance from the wall, from a minimum nearest the wall of about 10◦ (although by z/δ =0.1 the latter had increased to 20◦). \nThe ==inertial sublayer covered the range $1.85 &lt;z/h&lt; 2.3$== (Cheng and Castro, 2002) and a clear correlation peak was detected even with the traversing probe well above this log-law region, so our data support the idea that coherent turbulence structures appear not only in the near-wall region and logarithmic regions but also well into the middle of the boundary layer, as reported by Adrian et al. (2000). These organised structures may be the main eddies associated with near wall transport processes and thus would have an important role in effecting pollutant dispersion over urban roughness. However, this is not yet proven and it is at least possible that the small-scale structures near z=h, discussed in the previous section, will be crucial in contributing to transport of scalar quantities across the strong shear region between the lower canopy flow and the upper part of the roughness sublayer.\nThe turbulent kinetic energy (TKE) budget illustrates the relative importance of the physical processes that govern the turbulent flow. For stationary flow with no buoyancy forces under neutral conditions, the TKE balance can be simplified as:\n\n\\frac{Dk}{Dt}=-\\overline{uw}\\frac{\\partial U}{\\partial z}+\\left( \\overline{w^2}-\\overline{u^2} \\right) \\frac{\\partial U}{\\partial x}-\\frac{1}{\\rho}\\frac{\\partial \\overline{wp}}{\\partial z}-\\frac{\\partial \\overline{wk}}{\\partial z}-\\epsilon​                                                      $A$                   $P{ss}$                   $P{sn}$                            $T_p$               $T_t$     $D$\n  where $2k≡q^2=(u^2+v^2+w^2)$, $\\overline{wk}=(\\overline{u^2w}+\\overline{v^2w}+\\overline{w^3})/2$ and we assume that $\\overline{v^2w}=(\\overline{u^2w}+\\overline{w^3})/2$. In the above equation, $A$, $P{ss}$, $P{sn}$, $T_p$, $T_t $ and $D$ are the advection, shear production, normal stress production, pressure transport, turbulent transport and dissipation terms, respectively.                                           \n $A$, $P{ss}$, $P{sn}$, $T_p$, $T_t $ can be calculated directly from the measurements and $D$​ can be estimated from power spectral density measurements, with an error of perhaps 20% at most. \n\n$k$ here is the wavenumber defined by $k =2πf/U$ and $z’ =z−d$.\n==$T_p$​ can be inferred indirectly as a residual after determination of all other terms from the experimental data.== \n\nFigure 10 shows the resulting balances for P0 and P3; all terms have been normalized by ($U^3_r /δ$). Note first that the significance of the normal stress production term is quite different at the two locations. It is almost as large as shear production in the roughness sublayer at $P_0$ (Figure 10a). This is perhaps not surprising since the flow is spatially much more inhomogeneous than in a regular boundary layer and this inhomogeneity may well be largest (e.g. longitudinal gradients are largest) immediately over a cube, where the shear layers separating from the leading edges are developing most rapidly. Secondly, observe that the residual term is consistently large and negative at $P_3$. This suggests that pressure transport is relatively significant, although it is possible that the errors in the measured terms contribute significantly to this residual. Certainly, at $P_0$, the residual is rather more scattered, but it is consistently of opposite sign to that at $P_3$​, representing a source of energy rather a sink. As expected, shear production is approximately balanced by the dissipation in the surface layer at both locations and the turbulent transport term is a measurable energy sink there.\nConclusions\nanalysing single- and two-point velocity statistics obtained in flow over urban roughness in a wind tunnel\nExamination of the turbulent kinetic energy budget indicates that shear production is a principle source of energy in the region above the canopy, as expected, and that turbulent transport plays an important role in the surface layer. \nAround the top of the canopy region there is some evidence of two-scale behavior,\n7.(2024)Effect of urban morphology and an upstream tall building on the scale interaction between the overlying boundary layer and a street canyonHaoran Du · Laurent Perret · Eric Savory\nThe interaction of large- and small-scale velocity fluctuations between a street canyon flow and the overlying boundary layer, under the influence of a local morphological model and a single upstream tall building, is investigated.\nUnderstanding the dynamic transport of air and pollutants across the shear layers of street buildings to the overlying atmospheric boundary layer is crucial to the enhancement of urban air quality.\nIn the case of both a large enough ratio of boundary layer thickness to roughness $δ/h_1$​ and a δ+ = δu∗/ν), the inertial layer (or the log-layer) of an urban-type rough-wall boundary layer has qualitatively similar dynamical and structural properties as smooth-wall turbulent boundary layer flows (Volino et al. 2007; Takimoto et al. 2013;Perretetal. 2019), containing coherent structures such as Large-Scale Motions (LSMs), which are packets of hairpin vortices (Zhou et al. 1999;Adrianetal. 2000), and Very Large-Scale Motions (VLSMs) (Marusic et al. 2010b), which are elongated, low- and high-momentum regions meandering horizontally above the wall.\n\nHow does the morphology impact the scale interaction in the overlying boundary layer and the street canyon, in comparison with the homogeneous roughness model?\nWhat is the impact of a single upstream tall building and its height on the scale interaction in the boundary layer and the street canyon?\nWill an irregularly-shaped upstream tall building affect the scale interaction, in comparison with an idealized regular, symmetric building?\n\nExperiment\n\nWind tunnel: This open-loop wind tunnel has test section dimensions of 24m (length) × 2m (width) × 2m (height) and a 5:1 ratio inlet contraction.\nfive vertically tapered spires measuring 800mm in height and 134mm in base width were positioned at the beginning of the test section, after which a solid fence measuring 200mm in height and then a 17m fetch of staggered cubes of height $h1 = 50 mm$ and plan area density $λp1= 25%$ were placed across the test section to fully develop the boundary layer flow.\nA1:200 scalemorphographicmodel\nA Dantec stereoscopic particle image velocimetry (S-PIV) system was used to measure the 3-component velocity fields\nA Litron double cavity NdYAG laser (2 × 200 mJ), light sheet in the XZ plane.\nOlive oil droplets of 1 µm average diameter generated by a LaVision Laskin-Nozzle aerosol generator\nTwo 2048 × 2048 CCD cameras with 105mm objective lenses were installed under the wind tunnel floor on each side of the light sheet and angled at 45◦ towards the sheet. \n10,000 pairs of images were recorded at a frequency of 7.4 Hz, with a time delay of 300 µs between two images of the same pair. \nThe final spatial resolution for the experiments was 1.6 mm (0.022 Wc) and 3.2 mm (0.028 h2) in the streamwise (x) and vertical directions (z), respectively. \nfinal interrogation window size of 32 × 32 pixels with an overlap of 50%. \nFive single hot-wire anemometer (HWA) probes with a sampling frequency of 15 kHz, were evenly placed in the lateral direction with a spacing of 50mm (0.25 Wb)at z/h = 3 over the centre of the downstream street canyon building. ==The HWA measurements were performed synchronously with the PIV measurements.==\n\n\nPOD-LSE\n\nThe streamwise length scales of the large-scale streamwise velocity fluctuations are estimated using the temporal auto-correlation $R_{u_Lu_L}$​ and Taylor’s hypothesis of frozen turbulence,\n\nL_{u_L}\\left( z \\right) =\\overline{U}\\left( z \\right) \\int_0^{\\infty}{R_{u_Lu_L}\\left( z, \\tau \\right)}d\\tauSkewness Decomposition3[2]Blackman K, Perret L, Savory E (2018) Effects of the upstream flow regime and canyon aspect ratio on non-linear interactions between a street-canyon flow and the overlying boundary layer. Boundary-Layer Meteorol 169:537–558\n\nu'=u_L'+u_S'\n\\\\\nu'^3=\\left( u_L'+u_S' \\right) ^3\n\\\\\nu'^3=u_L'^3+3u_L'^2u_S'+3u_L'u_S'^2+u_S'^38.(2024)Automated large‐scale and terrain‐induced turbulence modulation of atmospheric surface layer flows in a large wind tunnelNasreldin O. Mokhtar · Pedro L. Fernández‐Cabán1 · Ryan A. Catarelli\n\n9.Secondary motions and wall-attached structures in a turbulent flow over a random rough surface10.（2018）Effects of the Upstream-Flow Regime and Canyon Aspect Ratio on Non-linear Interactions Between a Street-Canyon Flow and the Overlying Boundary LayerKarin Blackman1 · Laurent Perret1,2 · Eric Savory3\nUseful expressions: RSL, ISL, scale interaction\n1.==The flow associated with street canyons that form the urban-canopy roughness comprises several regions, including the roughness sublayer, whose depth depends on the density and height of the roughness elements, and the inertial layer, which contains large-scale structures influenced by the surface characteristics (Rotach et al. 2005). Within these regions, the flow comprises complex coherent structures that have been identified through direct numerical simulation (DNS) (Coceal et al. 2007; Lee et al. 2011, 2012), wind-tunnel experiments (Castro et al. 2006; Takimoto et al. 2013) and field experiments (Inagaki and Kanda 2008, 2010).==\n2.==These coherent structures consist of large-scale turbulent organized motions of either high or low momentum that form well above the roughness in the inertial layer, shear layers that form within the roughness sublayer along the top ofthe upstream roughness elements and contain small-scale structures induced by the presence of the roughness, and a recirculation region within the street canyon (Coceal et al. 2007).== \n3.==These structures, especially how they interact with one another, are ofparticular interest since they govern the intermittent turbulent events, such as ejections (Q2: u &lt; 0and w &gt; 0) and sweeps (Q4: u &gt; 0and w &lt; 0), that produce the transport of heat, momentum and pollution between the street canyon and the overlying roughness sublayer and inertial layer (Takimoto et al. 2011; Perret and Savory 2013).== \n4.==The present study focuses on the roughness sublayer and lowest region of the inertial sublayer, since this is the region in which scale interactions important to the ventilation of street canyons are expected to occur.==\nTarget: \n\nWhat is the quantitative influence of the roughness configuration on the non-linear relationship between large-scale structures in the inertial layer and small-scale structures induced by the presence of the roughness in the roughness sublayer?\n\nWhat is the quantitative influence of the street-canyon aspect ratio on this non-linear relationship?\n\n\nExperiment:\nwind tunnel: $2m(W)\\times 2m(H) \\times 24m(L)$​. The freestream turbulence intensity within the empty wind tunnel of $0.5$% with spanwise uniformity to within $\\pm 5$%.\nFive 800-mm vertical tapered spires were used immediately downstream of the contraction to initiate the boundary-layer development and were followed by a $200$-mm high solid fence located $750$ mm downstream of the spires. An initial $13$-m fetch of $50$-mm staggered cubic roughness elements with a plan area density of $\\lambda_p=25$ % was used to further develop the boundary layer. The roughness elements over the remaining portion of the wind tunnel were either 50-mm cubes (arranged in a staggered array with $\\lambda_p=25$ % ) or 50-mm square-section, 2D bars that spanned the width of the tunnel, with an element spacing of either 1h ($\\lambda_p=25$ % ) or 3h ($\\lambda_p=25$ % ). These configurations result in a $1\\colon200$​ scaling of a suburban-type atmospheric boundary layer (Blackman et al. 2015).\nBoundary-Layer Characteristics:\nThe logarithmic-law parameters, aerodynamic roughness length ($z0$) and displacement height ($d$), were determined by fitting the vertical profile of the streamwise velocity component to the logarithmic law (Blackman et al. 2015) while the friction velocity, $u\\ast$, was estimated from the vertical profile of the Reynolds shear stress in the constant-stress region located just above the roughness elements. ==Within the wind tunnel a region of constant stress is not typically observed so the shear stress must be approximated by an average of the shear stress over a region, selected based on a combination of the flattest region of the profile and the expected value for the configuration from the literature.== \nAlthough we recognize that this method of estimating $u_\\ast$​ does not normally yield accurate results in rough-wall boundary layers the conclusions are unlikely to be affected. For further details, see Blackman1.\nThe skimming-flow regime (R1h) is shown to increase $\\overline{u}$ ,  $\\sigma_u$, $\\sigma_w$ and $\\sigma_v$, while $\\overline{u’w’}$ decreases compared to the wake-interference regime (R3h). The 3D roughness (Rcu) falls between the skimming-flow and wake-interference-flow regimes except in the case of $\\sigma_w$ and $\\sigma_v$​​, which are similar to wake-interference profiles.\nStochastic Estimation Model23\nIn the stochastic estimation method the approximated near-wall large-scale fluctuating velocity ($\\widetilde{u^{\\prime NW}}$) is calculated at each location of interest from coefficients ($A{l}^{n}$) and a reference velocity signal ($u{L}^{\\prime BL}$​​​).\nThe LSE coefficients ($A_{l}^{n}$ ) are determined from the cross-correlation of the low-pass filtered large-scale fluctuations and the raw near-wall PIV signal at the location in space (x, y, z) that is to be predicted, as well as the autocorrelation of the large-scale signal,\nA time lag $\\Delta t=0.2$ s with a maximum delay of t −1 s to 1 s is introduced to these correlations to preserve the time separation of the conditional and unconditional events so that each coefficient represents the correlation between events at a specific instance in time. $N_{ref}$ is the number of reference locations and $2N_t + 1$​ is the number of time lags used.\nConceptual figure:\n\nInspiration:\nCalculate the $R{\\widetilde{u}{L}u_{S}^{2}}$,\nR_{\\widetilde{u}_{L}u_{S}^{2}}(x_{S},z_{S},x_{L},z_{L},\\tau_{L})=\\frac{\\widetilde{u_{L}^{\\prime}}(x_{L},z_{L},t+\\tau_{L})u_{S}^{\\prime2}(x_{S},z_{S},t)}{\\sqrt{\\widetilde{u_{L}^{\\prime}}^{2}(x_{L},z_{L})}\\sqrt{u_{S}^{\\prime2}(x_{S},z_{S})}^{2}}\n\n\n\nCalculate the inclined angle from the hot-wire data by Taylor hypothesis.\n\nThe introduction, excellent.\n\n\n11.(2016)Non-linear interactions in a boundary layer developing over an array of cubes using stochastic estimationKarin Blackman1,a) and Laurent Perret1,2\nIn the present work, a boundary layer developing over a rough-wall consisting of staggered cubes with a plan area packing density, $\\lambda_p$ = $25$%, is studied within a wind tunnel using combined particle image velocimetry and hot-wire anemometry to investigate the non-linear interactions between large-scale momentum regions and small-scale structures induced by the presence of the roughness.\nAnalysis of the scale-decomposed skewness of the turbulent velocity ($u’$) shows a significant contribution of the non-linear term $\\overline{u^{\\prime}_Lu_S’^{2}}$ , which represents the influence of the large-scales ($u’_L$) onto the small-scales ($u’_S$). It is shown that this non-linear influence of the large-scale momentum regions occurs with all three components of velocity in a similar manner. \n\n==The depth of the roughness sub-layer depends on the density and height of the roughness elements and is followed by the inertial layer where the turbulence contains large-scale structures that are influenced by the surface characteristics==\n==Within these regions the flow is comprised of complex coherent structures that have been identified through Direct Numerical Simulation (DNS)== \n==These coherent structures consist of== \n==(1) large-scale turbulent organized structures of either high or low momentum that form well above the roughness in the inertial layer from groups of hairpin vortices;== \n==(2) shear layers that form within the roughness sub-layer along the top of the upstream roughness elements and contain small-scale structures induced by the presence of the roughness;== \n==(3) a recirculation region within the canopy layer (Fig. 1)==\nSeveral methods have been used to identify and separate large-scale fluctuations within therough-wall boundary layer such as Proper Orthogonal Decomposition (POD) (Perret and Rivet, 2013), wavelength spectral filtering (Nadeem et al., 2015), and spatial filtering \n12.(2017)Self-similarity of wall-attached turbulence in boundary layersWoutijn J. Baars1,†, Nicholas Hutchins1 and Ivan Marusic1\nspectral coherence analysis\n‘self-similar’ will refer to the feature of geometrical self-similarity of various-sized turbulent motions. ‘Wall-attached’ will refer to the energy portions of turbulent fluctuations in the outer region, which are coherent with the wall-shear stress signature or the velocity fluctuations at a reference position deep within the near-wall region.\nReferences\n1. Blackman K, Perret L (2016) Non-linear interactions in a boundary layer developing over an array of cubes using stochastic estimation. Phys Fluids 28:095108 &#8617;\n\n\n2. Perret L, Blackman K, Savory E (2016) Combining wind-tunnel and field measurements of street-canyon flow via stochastic estimation. Boundary-Layer Meteorol 16:491–517 &#8617;\n\n\n3. Blackman K (2014) Influence of approach flow conditions on urban street canyon flow. M.E.Sc. Dissertation, University ofWestern Ontario, Canada &#8617;\n\n\n4. Blackman K, Perret L, Savory E. Effects of the upstream-flow regime and canyon aspect ratio on non-linear interactions between a street-canyon flow and the overlying boundary layer[J]. Boundary-layer meteorology, 2018, 169: 537-558. &#8617;\n\n","categories":["turbulence"],"tags":["turbulence"]},{"title":"Turbulence Energy Budget","url":"/2024/01/23/Turbulence-Energy-Budget/","content":"turbulence energy budgetThe turbulence energy budget calculation is a fundamental aspect of fluid dynamics, particularly in understanding turbulent flows. This calculation involves the analysis of the kinetic energy associated with turbulent eddies in a fluid. By examining the turbulence energy budget, you can gain insights into several key aspects of the flow:\n\nProduction of Turbulent Kinetic Energy (TKE): This refers to the rate at which turbulent kinetic energy is generated. It’s often associated with the shear in the flow, such as that caused by velocity gradients. Understanding the production of TKE can help in identifying regions in the flow where turbulence is being generated most intensely.\nDissipation Rate: Turbulent kinetic energy is eventually dissipated into heat due to viscous effects at the molecular level. The dissipation rate is a crucial factor in determining the smallest scales of the turbulence and the overall energy balance. It helps in understanding how energy is transferred from large scales (where it is produced) to small scales (where it is dissipated).\nTransport of Turbulent Energy: This includes both the advection of turbulent energy by the mean flow and the diffusion of turbulent energy due to turbulent fluctuations. Understanding how turbulent energy is transported can be important in predicting the spread and mixing of turbulence in a flow.\nPressure Work and Buoyancy Effects: In some flows, particularly those affected by gravity or other body forces, the work done by pressure forces and buoyancy can significantly affect the turbulence energy budget. This is especially relevant in atmospheric and oceanic flows.\nRedistribution of Energy Among Turbulent Scales: The turbulence energy budget can also provide insights into the energy cascade process, where energy is transferred from larger to smaller scales of motion, or vice versa in some cases. This is a key aspect of the energy dynamics within turbulent flows.\nModeling and Simulation Inputs: For computational fluid dynamics (CFD) and other simulation tools, understanding the turbulence energy budget is crucial for developing and validating turbulence models. These models are essential for predicting turbulent flows in engineering and scientific applications.\nFlow Stability and Transition to Turbulence: The energy budget can also give insights into the stability of the flow and its transition from laminar to turbulent, which is important in many practical applications, such as in aerodynamics and process engineering.\nEnvironmental and Geophysical Applications: In environmental fluid dynamics, such as in the study of oceans, atmosphere, and rivers, the turbulence energy budget helps in understanding mixing processes, pollutant dispersion, and energy transfers at different scales.\n\nBy analyzing the turbulence energy budget, engineers and scientists can design more efficient systems, predict environmental impacts, and understand natural phenomena better. It’s a key tool in both theoretical studies and practical applications involving turbulent flows.\n","categories":["turbulence"],"tags":["turbulence"]},{"title":"Why (n-1) when calculating sample variance?","url":"/2023/09/28/Why-n-1-when-calculating-sample-variance/","content":"Why (n-1) when calculating sample variance?\nSuppose sample mean \n\n\\overline{X}sample variance \n\nS^2Overall mean\n\n\\muOverall variance \n\n\\sigma^2\nS^2=\\frac{1}{n-1}\\sum_{i=1}^n{\\left( X_i-\\overline{X} \\right)}^2if \n\nS^2=\\frac{1}{n}\\sum_{i=1}^n{\\left( X_i-\\overline{X} \\right)}^2Then\n\nE\\left( S^2 \\right) =E\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left( X_i-\\overline{X} \\right) ^2} \\right)\n=E\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left[ \\left( X_i-\\mu \\right) -\\left( \\overline{X}-\\mu \\right) \\right] ^2} \\right)\n=E\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left[ \\left( X_i-\\mu \\right) ^2-2\\left( X_i-\\mu \\right) \\left( \\overline{X}-\\mu \\right) +\\left( \\overline{X}-\\mu \\right) ^2 \\right]} \\right) \n\\\\\n=E\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left( X_i-\\mu \\right) ^2-\\frac{2}{n}\\sum_{i=1}^n{\\left( X_i-\\mu \\right) \\left( \\overline{X}-\\mu \\right) +\\frac{1}{n}\\sum_{i=1}^n{\\left( \\overline{X}-\\mu \\right) ^2}}} \\right) \n\\\\Note：\n\n\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left( X_i-\\mu \\right) ^2}=\\frac{1}{n}\\sum_{i=1}^n{X_i-\\mu =\\overline{X}-\\mu =\\frac{1}{n}\\sum_{i=1}^n{\\left( \\overline{X}-\\mu \\right)}} \\right)\n=E\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left( X_i-\\mu \\right) ^2}-\\frac{2}{n}\\sum_{i=1}^n{\\left( \\overline{X}-\\mu \\right) ^2}+\\frac{1}{n}\\sum_{i=1}^n{\\left( \\overline{X}-\\mu \\right) ^2} \\right) \n\\\\\n=E\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left( X_i-\\mu \\right) ^2}-\\frac{1}{n}\\sum_{i=1}^n{\\left( \\overline{X}-\\mu \\right) ^2} \\right) \n\\\\\n=E\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left( X_i-\\mu \\right) ^2} \\right) -E\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left( \\overline{X}-\\mu \\right) ^2} \\right) \n\\\\\n=\\sigma ^2-E\\left( \\frac{1}{n}\\sum_{i=1}^n{\\left( \\overline{X}-\\mu \\right) ^2} \\right) \n\\\\\n","categories":["turbulence"],"tags":["turbulence"]},{"title":"Hello World","url":"/2022/07/03/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo n &quot;My New Post&quot;== $ hexo new &quot;My New Post&quot; \nGenerate$ hexo g &quot;My New Post&quot;== $ hexo generate &quot;My New Post&quot; \nMore info: Writing\nRun server$ hexo s == $hexo server\nMore info: Server\nGenerate static files$ hexo generate\nMore info: Generating\nDeploy to remote sites$ hexo deploy\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n$npm install hexo -g #install hexonpm update hexo -g #upgradehexo init #initialize\ncommand\nhexo server #Hexo will monitor the changes and auto-update without reboothexo server -s #static modehexo server -p 5000 #change porthexo server -i 192.168.1.1 #self-define IPhexo clean #clean cache\n","categories":["MATLAB"]},{"title":"imgrate test","url":"/2024/04/05/imgrate-test/","content":"精准与否，是屠宰与手术的区别时间不在于你拥有多少，而在于你怎样使用坏人总是太多，时间又太短世间万物，皆系于一箭之上\n"},{"title":"小梁庄没有什么新闻","url":"/2023/05/24/%E5%B0%8F%E6%A2%81%E5%BA%84%E6%B2%A1%E6%9C%89%E4%BB%80%E4%B9%88%E6%96%B0%E9%97%BB/","content":"\n小梁庄是一个普普通通的村子，与中国土地上许许多多其他的村庄没有太大区别，村子里有两姓人家，梁和李。梁姓人口占了大多数，所以村子名叫小梁庄，当然，与之相对应的还有一个数十里之外的大梁庄，大小的叫法也完全取决于两个村子的规模和总人口数。村子东侧有一条河，河岸西侧的小梁庄和东侧齐庄以河为界，村民们便劳作在流淌的河。在我小时候这条河河水充盈，一条小小的漫水桥上常年流水不断，桥面上因此长满的绿藻酿成了许多或大或小的交通事故，曾让过往的行人都战战兢兢。河水夏涨秋落，每年夏天都有一个伴随暴雨的汛期，彼时河水漫过两岸，将整个村子通往小镇与学校的路都堵死，那是村上孩童许多高兴事中的一个。\n我目睹了这个村子二十多年的变迁。村民们曾经拉着架子车去交公粮，也曾东躲西藏逃避十户连坐的计划生育。从前的草房瓦房土坯墙，在茂密的丛林间升起缕缕炊烟。我曾见过这个村庄上庆祝各个节日时简单但很庄重的习俗，清明时节各家各户门前插上两支垂柳；端午则有老人们用艾草缝制香囊，孩童在手腕脚腕及脖颈上系上五色线、耳朵及肚脐眼上抹上雄黄酒防虫防病；中秋有月饼冬至有饺子，腊八则有腊八粥。年关则是最热闹的时刻，除去赶集准备年货，贴春联，还有各种爆竹声不绝于耳，有的来自于孩童燃放鞭炮，更多的是来自各家各户饭前传统的一挂炮以及祭祖的炮鸣。而今大部分节日的活动已隐尘入土，在时间的河流中翻不起一点点波澜，只剩下春耕秋收和春节爆竹还在诉说着农耕文化与乡土中国在小梁庄上留下的最后一声回响。我见过两个空壳的村庄，村民早已离开，只留下了空荡且破旧的砖瓦房。我似乎看到了小梁庄的相似结局，只不过她的历史进程没有那么快。这些先辈傍水而居，我不知道他们从哪里来，但我知道，这里终究会回到他们来之前的样子。\n\nmodified 2023/02/06\n","categories":["journal"],"tags":["dairy"]},{"title":"离我最近的是风声","url":"/2022/07/03/%E7%A6%BB%E6%88%91%E6%9C%80%E8%BF%91%E7%9A%84%E6%98%AF%E9%A3%8E%E5%A3%B0/","content":"\n\n人对季节的敏感性还是很神奇，尽管香港算是四季花常开，但唯有这个时候，才能在脑海中浮现出一片桃李盛开的景象。\n\n加之晴热的天气，这种从季节到天气引起的感觉变化总会让人想到以前的一些场景。\n\n比如走在路上看到铺满地面的阳光时，让我想到去年此时写毕业论文的情形。千佛山校区的校园里紫藤花开满了走廊，阳光倾泻一地，每个在走向工作室的路上，额头流着汗，内心却寒意十足。每个走在回宿舍路上的夜晚，偶尔有人三三两两在路上，路灯亮彻小路，梦里却是数不尽的黑洞，我不知道那种悲凉从何处来，只觉得睡一觉会很好，但睡一觉也并不觉得有多好。\n\n比如早上醒来的鸟鸣。这声响一下子又把我带回2020年初疫情初发待在家里的时光。早上的阳光照在窗外的棕榈树上，偶尔有喜鹊或者脚上系着彩带的鸽子落在墙头上，叽叽喳喳或者咕咕叫。我偷偷摸摸拿着镰刀走出大门给一只兔子割草，总害怕被村里的乡亲碰到不知如何问候。那时候我在想，如果疫情终究不可避免，发生在秋天才好，这样才能看一次院子里的桂树开花。常常在电话中听闻花开，却从未亲眼见过，觉得多少是种遗憾，恰好那时千佛山校区的校园里有一棵桂花树，每当我走近的时候都会在想，不知道家里的那棵开了没有。幸运的是，在我研究生毕业后的暑假因为签注的延迟看到了这棵桂树的花。\n\n这鸟鸣声唤起我最遥远的记忆却是来自很小的时候。我无法确切地说出是几岁，也不知道这是什么鸟，只觉得这种微凉的清晨伴随着一声声鸟鸣，仿佛置身荒野，既熟悉又陌生，周围的一切似乎发生在昨天，又恍若隔世。好像是好多年前下满露水的清晨，爸妈冒着露水起早去地里摘棉花，锅里装满了米，并在临行前叮嘱我起床去烧火。又或者我跟他们一起早起去种花生或者玉米，他们用锄头刨一个坑，我一边丢进两粒种子，一边在想这漫漫的田地何时才能种完，只想早早干完回家吃饭，远远望去，已有几缕炊烟在村子里升起。这时候田地边的水坑里，会传出这种鸟鸣，这不是一种多音节的鸟鸣，而是只有一个音节的绵长的叫声，从强到弱，昏昏欲睡又悲凉至极，与杜鹃的叫声完全不同。乡下那种最为常见的杜鹃，则有四个音节，一声一声，在文人耳中，那声音唤作“不如归去”，在这烟火人间则更像是“割麦种豆”。村子还是那个村子，不为外人所知的小梁庄，以及一条无名的河。但是这种鸟叫声我已经很久没有听到了。\n\n如今，一晃竟然二十多年了，很快年龄会以三字打头。想到这一点，就会感到恐惧，并非恐惧这时光流逝不可阻断，而是恐惧这种缓慢的步履跟不上年龄增长的虚无感以及记忆中不断消失又重现的年少残像。他们在一边，我在另一边。以前种种不经意地映入脑海，往事如烟吗？只怕是往事并不如烟。\n\n我想起那些时候不止因为那时的一些人或事，更重要的是，那个时候的我，比现在更年轻。\n\n而现在，我只能站在山与海交界的地方，海风穿过高楼没入山林，云雾垂天而下掉落山头，晚霞从海岸线慢慢后撤，涂抹在斜坡上坟场的墓碑上。\n\n我不能想象此后三五年的光景，只希望现在能像风一样自由。\n\n\n\n\n\n2022.05.13\nmodified 2022.07.04\n","categories":["journal"],"tags":["dairy"]}]